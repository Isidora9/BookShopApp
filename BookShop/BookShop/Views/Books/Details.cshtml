@model BookShop.Domain.Entities.Book

@{
    ViewData["Title"] = "Details";
}

<style>

img{
    max-height: 400px;
}

</style>

<div>
    <h1>@Html.DisplayFor(model => model.Title)</h1>
    <hr />
    <img src="@Html.DisplayFor(model => model.ImgUrl)"/>
    <dl class="row">
        <dt class = "col-sm-2">
            @Html.DisplayNameFor(model => model.Author)
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.Author)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Genre)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Genre)
        </dd>
        <dt class = "col-sm-2">
            @Html.DisplayNameFor(model => model.Description)
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.Description)
        </dd>
        <dt class = "col-sm-2">
            @Html.DisplayNameFor(model => model.Price)
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.Price)
        </dd>
        @* <dt class = "col-sm-2">
            @Html.DisplayNameFor(model => model.AvailableBookNum)
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.AvailableBookNum)
        </dd> *@
    </dl>
</div>
@if (User.Identity.IsAuthenticated && User.IsInRole("Admin"))
{
    <div>
        <a asp-action="Edit" asp-route-id="@Model?.BookId" class="btn btn-primary mb-2">Edit</a>
    </div>
}
<a asp-controller="Shop" asp-action="Index" class="btn btn-primary"><< Back to Shop</a>

<h4 class="mt-5 mb-3">Comments</h4>
@if (Model.Comments != null)
{
    @foreach (var item in Model.Comments)
    {
        <figure class="py-2">
            <blockquote>
                <p>@item.Content</p>
            </blockquote>
            <figcaption class="blockquote-footer">
                @item.User.UserName, <cite title="Source Title">@item.CreatedAt</cite>
            </figcaption>
        </figure>
        <hr></hr>
    }
}

@if (User.Identity.IsAuthenticated && User.IsInRole("User"))
{
    @* <form class="my-5" asp-action="AddComment" method="post">
        <input type="hidden" name="bookId" value="@Model.BookId" />
        <textarea name="content" rows="4" cols="50"></textarea>
        <button type="submit">Add Comment</button>
    </form> *@
    <form class="my-5" asp-action="AddComment" method="post">
        <input type="hidden" name="bookId" value="@Model.BookId" />
        <div class="mb-3 col-sm-6">
            <textarea class="form-control" style="border-color: #808080;" id="comment" name="content" rows="4" placeholder="Enter your comment here..."></textarea>
        </div>
        <button type="submit" class="btn btn-primary">Add Comment</button>
    </form>
}

@section scripts {
    @if (TempData["ErrorMessage"] != null)
    {
        <script>
            alert("@TempData["ErrorMessage"]");
        </script>
    }
}

